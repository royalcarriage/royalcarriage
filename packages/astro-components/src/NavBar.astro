---
import CallButton from './CallButton.astro';
import CTAButton from './CTAButton.astro';

interface Props {
  target: string;
  siteName: string;
  navLinks: Array<{ href: string; label: string }>;
  accentColor?: string;
  logoUrl?: string;
}

const { target, siteName, navLinks, accentColor = 'blue', logoUrl } = Astro.props;
const currentPath = Astro.url.pathname;

const bookingUrl = `https://customer.moovs.app/royal-carriage-limousine/new/info?utm_source=${target}`;
const customerPortalUrl = `https://customer.moovs.app/royal-carriage-limousine`;
const quoteUrl = `https://customer.moovs.app/royal-carriage-limousine/request/new`;

const colorClasses: Record<string, { accent: string; bg: string; hover: string }> = {
  blue: { accent: 'text-blue-600', bg: 'bg-blue-50', hover: 'hover:text-blue-600' },
  rose: { accent: 'text-rose-600', bg: 'bg-rose-50', hover: 'hover:text-rose-600' },
  purple: { accent: 'text-purple-600', bg: 'bg-purple-50', hover: 'hover:text-purple-600' },
  slate: { accent: 'text-slate-600', bg: 'bg-slate-50', hover: 'hover:text-slate-600' }
};

const colors = colorClasses[accentColor] || colorClasses.blue;
---

<nav class="bg-white shadow-lg sticky top-0 z-50">
  <div class="container mx-auto px-4">
    <div class="flex justify-between items-center py-4">
      <!-- Logo / Brand -->
      <div class="flex items-center">
        <a href="/" class="flex items-center gap-2">
          {logoUrl && (
            <img src={logoUrl} alt={siteName} class="h-10 w-auto" />
          )}
          <span class={`text-xl font-bold text-gray-800 ${colors.hover} transition-colors`}>
            {siteName}
          </span>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center space-x-6">
        {navLinks.map(link => (
          <a
            href={link.href}
            class:list={[
              `text-gray-700 ${colors.hover} transition-colors font-medium`,
              currentPath === link.href && `${colors.accent} border-b-2 border-current`
            ]}
          >
            {link.label}
          </a>
        ))}

        <!-- Customer Account Dropdown -->
        <div class="relative group">
          <button
            class={`flex items-center gap-1 text-gray-700 ${colors.hover} transition-colors font-medium`}
            aria-label="Customer account menu"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
            <span>Account</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>

          <!-- Dropdown Menu -->
          <div class="absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border border-gray-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
            <div class="py-2">
              <a
                href={customerPortalUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition"
              >
                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
                </svg>
                <div>
                  <div class="font-medium">Customer Login</div>
                  <div class="text-xs text-gray-500">View trips & manage bookings</div>
                </div>
              </a>
              <a
                href={bookingUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition"
              >
                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                <div>
                  <div class="font-medium">New Booking</div>
                  <div class="text-xs text-gray-500">Book a new ride</div>
                </div>
              </a>
              <a
                href={quoteUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition"
              >
                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                </svg>
                <div>
                  <div class="font-medium">Get Quote</div>
                  <div class="text-xs text-gray-500">Request pricing</div>
                </div>
              </a>
              <div class="border-t border-gray-100 mt-2 pt-2">
                <a
                  href="tel:+12248013090"
                  class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-gray-50 transition"
                >
                  <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                  </svg>
                  <div>
                    <div class="font-medium">(224) 801-3090</div>
                    <div class="text-xs text-gray-500">Call us directly</div>
                  </div>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Desktop CTA Buttons -->
      <div class="hidden lg:flex items-center space-x-3">
        <CallButton target={target} location="navbar" size="sm" />
        <CTAButton target={target} location="navbar" size="sm" />
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-button"
        class={`lg:hidden text-gray-700 ${colors.hover} focus:outline-none`}
        aria-label="Toggle mobile menu"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="hidden lg:hidden pb-4">
      <div class="flex flex-col space-y-1">
        {navLinks.map(link => (
          <a
            href={link.href}
            class:list={[
              `text-gray-700 ${colors.hover} transition-colors font-medium py-3 px-4 rounded`,
              currentPath === link.href && `${colors.bg} ${colors.accent}`
            ]}
          >
            {link.label}
          </a>
        ))}

        <!-- Mobile Account Section -->
        <div class={`${colors.bg} rounded-lg p-4 mt-3`}>
          <div class="font-semibold text-gray-900 mb-3">Customer Account</div>
          <div class="space-y-2">
            <a
              href={customerPortalUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-2 text-gray-700 py-2"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
              </svg>
              Login to Account
            </a>
            <a
              href={quoteUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-2 text-gray-700 py-2"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
              </svg>
              Get Instant Quote
            </a>
          </div>
        </div>

        <div class="pt-3 space-y-2">
          <CallButton target={target} location="mobile-menu" size="md" class="w-full text-center" />
          <CTAButton target={target} location="mobile-menu" size="md" class="w-full text-center" />
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const menuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');

    if (menuButton && mobileMenu) {
      menuButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
    }
  });
</script>
